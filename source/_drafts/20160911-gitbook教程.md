---
title: gitbook 使用备忘
toc: true
comments: true
categories: 前端技术
tags: Git
date: 2016-09-11 15:41:18
photos:
description:
---
gitbook 首先是一个软件，正如字面定义的那样，它使用 Git 和 Markdown 来编排书本，如果用户没有听过 Git 和 Markdown，那么 gitbook 可能不适合你！
<!--more-->
## 安装使用 

```shell
$ npm install gitbook -g

# 常用命令

gitbook --version 
#查看当前使用的版本
gitbook ls 
#系统存在的 gitbook 版本
gitbook ls-remote 
#所有 gitbook 版本
gitbook fetch 
#下载对应的 gitbook 版本
gitbook current 
#当前目录使用的 gitbook 版本
```

gitbook 的基本用法非常简单，基本上就只有两步：

#### 创建书籍

使用 `gitbook init`，创建如下目录结构：

```
book/
├── README.md    //是对书籍的简单介绍。
└── SUMMARY.md   //是书籍的目录结构。

//README.md 和 SUMMARY.md 是两个必须文件。
```

根据自己的需求，修改SUMMARY.md，建立目录结构，示例如下：
```
# SUMMARY

* [Chapter1](chapter1/README.md)
  * [Section1.1](chapter1/section1.1.md)
  * [Section1.2](chapter1/section1.2.md)
* [Chapter2](chapter2/README.md)

```

同样可以修改README.md，修改之后，再次使用`gitbook init`命令，则会在当前目录下，根据的SUMMARY.md创建目录结构。示例如下：

```
book/
├── README.md
├── SUMMARY.md
├── chapter1
│   ├── README.md
│   ├── section1.1.md
│   └── section1.2.md
└── chapter2
    └── README.md
```


#### 编译书籍

书籍目录结构创建完成以后，现在就可以在对应的文件上，使用Markdown语法，进行编写你的内容了。编写完成后，通过`gitbook build`命令进行编译。

#### 预览书籍

也可以直接使用`gitbook serve`来编译和预览书籍了。`gitbook serve` 命令实际上会首先调用`gitbook build`编译书籍，完成以后会打开一个web服务器，监听在本地的4000 端口。

现在，可以用浏览器打开 [http://127.0.0.1:4000](http://127.0.0.1:4000) 查看书籍的效果。

现在，gitbook 为我们创建了书籍目录结构后，就可以向其中添加真正的内容了，文件的编写使用 markdown 语法，在文件修改过程中，每一次保存文件，`gitbook serve`都会自动重新编译，所以可以持续通过浏览器来查看最新的书籍效果！

## gitbook.com

GitBook.com 是一个围绕 gitbook 发行书籍的社区，于 2014 年初创，GitBook.com 提供免费和付费的服务，而且免费账户就可以享受诸多服务，包括：

* 本私有书籍
* 托管不限数量的公开书籍
* 售卖不限数量的书籍，并分享 80% 的书籍收入
* 不限数量的协作者
* 免费的在线书籍编辑器

#### 发布书籍至gitbook

使用 `gitbook init`, `gitbook serve` 来预览，完成后，

可以提交修改：`git commit -am "init book"`

然后在gitbook上注册、创建书籍后

通过`git push`发布内容 


## gitbook 发布到 Github Pages

除了能够将书籍发布到 `GitBook.com` 外，还可以将书籍发布到 `GitHub Pages`，由于没有找到官方文档，所以这里记录的是我自己正在使用的一种方法。

如果读者不了解 `GitHub Pages` 为何物，简单说就是一个可以托管静态网站的 `Git` 项目，支持使用 markdown 语法以及 Jekyll 来构建，或者直接使用已经生成好的静态站点。

由于 gitbook 书籍可以通过 gitbook 本地构建出 site 格式，所以可以直接将构建好的书籍直接放到 GitHub Pages 中托管，之后，可以通过如下地址访问书籍：

`username`.github.io/`projectname`

例如：这本书中使用的例子 'test' 项目可以通过地址：lion1ou.github.io/test 来访问。

当访问 lion1ou.github.io/test 时，会访问 lion1ou/test 项目的 gh-pages 分支的内容，所以需要为项目创建一个 gh-pages 分支，并且将静态站点内容放入其中。也就是说，test 项目将有如下两个分支：

* master, 保存书籍的源码
* gh-pages, 保存书籍编译后的 HTML 文件

### 构建书籍

首先，使用 `gitbook build` 将书籍内容输出到默认目录，也就是当前目录下的 _book 目录。

```shell
$ gitbook build
Starting build ...
Successfully built!

$ ls _book
GLOSSARY.html   chapter1    chapter2      gitbook             
glossary_index.json   index.html    search_index.json
```

### 创建 gh-pages 分支

执行如下命令来创建分支，并且删除不需要的文件：

```shell
$ git checkout --orphan gh-pages
$ git rm --cached -r .
$ git clean -df
$ rm -rf *~
```
现在，目录下应该只剩下 _book 目录了，首先，忽略一些文件：

```shell
$ echo "*~" > .gitignore
$ echo "_book" >> .gitignore
$ git add .gitignore
$ git commit -m "Ignore some files"
```
然后，加入 `_book` 下的内容到分支中：

```shell
$ cp -r _book/* .
$ git add .
$ git commit -m "Publish book"
```

### 上传书籍内容到 GitHub

现在，可以将编译好的书籍内容上传到 GitHub 中 test 项目的 gh-pages 分支了，虽然这里还没有创建分支，上传和创建会一步完成！

```shell
$ git push -u origin gh-pages
Counting objects: 49, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (45/45), done.
Writing objects: 100% (49/49), 1.34 MiB | 131.00 KiB/s, done.
Total 49 (delta 5), reused 0 (delta 0)
To https://github.com/chengweiv5/test.git
 * [new branch]      gh-pages -> gh-pages
Branch gh-pages set up to track remote branch gh-pages from github.
```
现在，书籍的内容已经上传到 GitHub 上，所以通过访问 lion1ou.github.io/test 就可以阅读 test 这本书了！

注意：由于我将 lion1ou.github.io 重定向到了个人站点 lion1ou.win，所以可以看到，浏览器中的 URL 自动变成了 lion1ou.win/test，非常 cool! 


**转载请标注原文地址**


